model Comment {
  id   String @id @default(uuid())
  text String

  parentId String?
  parent   Comment?  @relation("CommentReplies", fields: [parentId], references: [id])
  replies  Comment[] @relation("CommentReplies")

  postId String
  post   Post   @relation(fields: [postId], references: [id], onDelete: Cascade)

  authorId String
  author   User   @relation(fields: [authorId], references: [id], onDelete: Cascade)

  isDeleted Boolean @default(false)

  entities CommentEntity[]

  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  reactions Reaction[]
}

model CommentEntity {
  id String @id @default(uuid())

  commentId String
  comment   Comment @relation(fields: [commentId], references: [id], onDelete: Cascade)

  type   String
  offset Int
  end    Int
  model  EntityModel

  targetId String
  text     String
}

enum EntityModel {
  USER
  HASHTAG
}
